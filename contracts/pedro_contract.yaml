name: rover_diff_drive
version: 1


robot_type: rover
rate_hz: 10.0 
max_duration_s: 120.0

metadata:
  task:
    type: constant
    value: rover_diff_drive

observations:

  - key: observation.image.main
    topic: /camera/color/foxglove
    image: 
      resize: [360,640]
    type: foxglove_msgs/msg/CompressedVideo
    align: {strategy: closest, stamp: foxglove, tol_ms: 0}
    qos: {reliability: best_effort, history: keep_last, depth: 10}

  - key: observation.state
    topic: /odometry/local
    type: nav_msgs/msg/Odometry 
    selector:
      names: [
        twist.twist.linear.x, twist.twist.angular.z
      ]
    align: {strategy: closest, stamp: header, tol_ms: 150}
    qos: {reliability: best_effort, history: keep_last, depth: 50}


actions:
  - key: action
    publish:
      topic: /motion_control/speed_controller/reference_cmd  
      type: geometry_msgs/msg/TwistStamped
      layout: flat
      qos: {reliability: best_effort, history: keep_last, depth: 10}
      strategy:
        mode: nearest  # 'fifo' | 'nearest' - nearest selects action closest to current time
        tolerance_ms: 500  
    selector:
      names: [twist.linear.x, twist.angular.z]
      #names: [twist.linear.x, twist.linear.y, twist.linear.z, twist.angular.x, twist.angular.y, twist.angular.z] 
    from_tensor:
      clamp: [-2.0, 2.0]
    safety_behavior: zeros

recording:
  storage: mcap